# Документація лінтингу проєкту

## Обраний лінтер та причини вибору

### SonarQube

SonarQube було обрано як основний інструмент статичного аналізу коду для цього Java Spring Boot проєкту з наступних причин:

- **Широке охоплення правил** - SonarQube має понад 600 правил для Java, які виявляють помилки, вразливості безпеки та code smells
- **Інтеграція з IntelliJ IDEA** - нативна підтримка через плагін SonarLint
- **Інтеграція з Spring Boot** - лінтер вміє перевіряти ін'єкці'ї залежностей, що є важливим для Spring Boot проєктів
- **Легкість використання в CI/CD** - SonarQube легко інтегрується з CI/CD системами і системами збірки

## Базові правила та їх пояснення

SonarQube використовує стандартну конфігурацію для Java, яка включає:

1. **Стиль коду**:
    - Обмеження на кількість параметрів (максимум 7)
    - Обмеження на складність методів і класів
    - Правила найменування змінних і методів

2. **Безпека**:
    - Виявлення SQL-ін'єкцій
    - Запобігання використанню незахищених API
    - Перевірка безпеки автентифікації

3. **Надійність**:
    - Виявлення потенційних NullPointerExceptions
    - Перевірка правильності роботи з потоками
    - Аналіз вичерпання ресурсів

4. **Продуктивність**:
    - Оптимізація використання колекцій
    - Виявлення неефективних алгоритмів
    - Перевірка неоптимальних запитів до бази даних

5. **Відхилення від найкращих практик**:
    - Виявлення застарілих API (deprecated)
    - Перевірка дублювання коду
    - Контроль розміру і складності класів

## Інструкція з запуску лінтера

### Локальний запуск

1. **Налаштування конфігурації лінтера**:
   Для цього необхідно створити файл `sonar-project.properties` у кореневій директорії проєкту і прописати необхідні зміни, інакше буде використовуватись конфігурація за замовчуванням.

2. **Запуск лінтера**:
    Спочатку необхідно зареєструватися на [SonarQube](https://sonarqube.org/) та створити проект. Після цього ви отримаєте токен доступу, який потрібно зберегти в змінній середовища `sonar.token`.
    Після цього перевірку можна запускати наступною командою:
    ```bash
    mvn sonar:sonar -Dsonar.host.url=http://localhost:9000 -Dsonar.login=${sonar.token}
    ```

### Використання в IntelliJ IDEA

Набагато легше запускати лінтер через плагін для IntelliJ IDEA - SonarQube. Це дозволяє отримувати миттєвий зворотний зв'язок під час написання коду, а також інтегруватися з локальним сервером SonarQube для синхронізації правил.
1. Встановіть плагін SonarQube через Marketplace в IntelliJ IDEA.
2. Після встановлення плагіна, відкрийте налаштування плагіна через `File -> Settings -> Tools -> SonarQube` та перевірте конфігурацію лінтера.
3. Для запуску перевірки можна натиснути `Ctrl + Shift + Alt + S` або вибрати `Analyze -> Analyze Code with SonarQube` з меню.
4. Результат перевірки з'явиться в нижній частині вікна IDE, де ви зможете переглянути всі проблеми, які були виявлені лінтером.

## Git hooks

У проекті налаштовано Git pre-commit хук через `githook-maven-plugin` для автоматичного запуску SonarQube перед кожним коммітом:

```xml
<pre-commit>mvn sonar:sonar -Dsonar.host.url=http://localhost:9000 -Dsonar.login=${sonar.token}</pre-commit>
```

Це гарантує, що всі зміни проходять аналіз якості коду перед тим, як потраплять до репозиторію. Для коректної роботи хука необхідно, щоб локальний сервер SonarQube був запущений, а токен доступу був збережений у змінній середовища `sonar.token`.

## Інтеграція з процесом збірки

SonarQube інтегрований у процес збірки через Maven плагін:

```xml
<plugin>
    <groupId>org.sonarsource.scanner.maven</groupId>
    <artifactId>sonar-maven-plugin</artifactId>
    <version>5.1.0.4751</version>
    <executions>
        <execution>
            <id>sonar-analysis</id>
            <phase>verify</phase>
            <goals>
                <goal>sonar</goal>
            </goals>
        </execution>
    </executions>
</plugin>
```

Це забезпечує автоматичний запуск аналізу якості коду під час фази `verify` процесу Maven.